define("node",[],function(){"use strict";var t=function(t){this.key=t,this.parent=null,this.offspring=null,this.leftSibling=null,this.rightSibling=null,this.prelim=0,this.modifier=0,this.level=0,this.width=60,this.height=80,this.x=0,this.y=0};return t.prototype={},t}),define("config",[],function(){"use strict";return{MaximumDepth:100,SiblingSeparation:80,SubtreeSeparation:80,LevelSeparation:120}}),define("dv",["./node","./config"],function(t,e){"use strict";var i=function(t){this.dom=document.getElementById(t),this.context=this.dom.getContext("2d"),this.context.save(),this.viewport={x:0,y:0}},n=0,r=[],o="";return i.prototype.toLeftMost=function(t){for(var e=t;null!=e.offspring;)e=e.offspring,n++;return e},i.prototype.toRightMost=function(t){for(var e=t;null!=e.offspring;)for(e=e.offspring;null!=e.rightSibling;)e=e.rightSibling;return e},i.prototype.toNextLevelLeftMost=function(t){return Object.assign({},t.offspring)},i.prototype.toNextLevelRightMost=function(t){var e=t.offspring;if(null!=e)for(;null!=e.rightSibling;)e=e.rightSibling;return e},i.prototype.postOrder=function(t){r[n]=new Array,r[n].push(t),t.level=n;for(var i=this.toLeftMost(t),o=null,l=null;null!=i.parent;)null==(l=i.leftSibling)?null!=i.offspring?(i.prelim=(i.offspring.prelim+o.prelim)/2,i.modifier=0):(i.prelim=0,i.modifier=0):null!=i.offspring?(i.prelim=l.prelim+e.SiblingSeparation+(l.width+i.width)/2,i.modifier=i.prelim-(i.offspring.prelim+o.prelim)/2):(i.prelim=l.prelim+e.SiblingSeparation+(l.width+i.width)/2,i.modifier=0),void 0==r[n]&&(r[n]=new Array),r[n].push(i),i.level=n,null!=i.rightSibling?(o=i,i=this.toLeftMost(i.rightSibling)):(o=i,i=i.parent,n--);for(var f=1;f<r.length;f++)for(var h=0;h<r[f].length;h++)for(var p=h+1;p<r[f].length;p++)this.adjust(r[f][h],r[f][p]);t.prelim=(t.offspring.prelim+o.prelim)/2,t.modifier=0},i.prototype.print=function(){for(var t=0;t<r.length;t++)for(var e=0;e<r[t].length;e++)this.printNode("节点：",r[t][e])},i.prototype.printNode=function(t,e){console.log(t,e.key,e)},i.prototype.getX=function(t){for(var e=0,i=t;null!=i.parent;)i=i.parent,e+=i.modifier;return t.prelim+e},i.prototype.adjust=function(t,i){if(null!=t.offspring&&null!=i.offspring){var n=this.toNextLevelRightMost(t),o=this.toNextLevelLeftMost(i),l=this.getX(n),f=this.getX(o),h=0;if(f-l<e.SubtreeSeparation+(t.width+i.width)/2&&(h=e.SubtreeSeparation+(t.width+i.width)/2-(f-l)),0!=h){for(;null!=i.parent.parent;)i=i.parent;i.prelim+=h,i.modifier+=h;for(var p=(r[1][0],0),a=1;a<r[1].length&&r[1][a]!=i;a++)p++;if(p>0)for(var s=h/(p+1),a=1;a<r[1].length&&r[1][a]!=i;a++)r[1][a].prelim+=s,r[1][a].modifier+=s}}},i.prototype.calculate=function(t,i){if(null!=t)for(t.x=t.prelim+i,t.y=t.level*(e.LevelSeparation+t.height),null!=t.offspring&&this.calculate(t.offspring,i+t.modifier);null!=t.rightSibling;)t=t.rightSibling,t.x=t.prelim+i,t.y=t.level*(e.LevelSeparation+t.height),null!=t.offspring&&this.calculate(t.offspring,i+t.modifier)},i.prototype.calculatePath=function(t){if(null!=t){if(null!=t.parent){var i=t.x+t.width/2,n=t.y-e.LevelSeparation/2;o+="M "+i+" "+t.y+"L "+i+" "+n}if(null!=t.offspring){var i=t.x+t.width/2,n=t.y+t.height+e.LevelSeparation/2;o+="M "+i+" "+(t.y+t.height)+"L "+i+" "+n;var r=this.toNextLevelLeftMost(t),l=this.toNextLevelRightMost(t),f=r.x+r.width/2,h=r.y-e.LevelSeparation/2,p=l.x+l.width/2,a=l.y-e.LevelSeparation/2;o+="M "+f+" "+h+"L "+p+" "+a,this.calculatePath(t.offspring)}for(;null!=t.rightSibling;){var i=(t=t.rightSibling).x+t.width/2,n=t.y-e.LevelSeparation/2;if(o+="M "+i+" "+t.y+"L "+i+" "+n,null!=t.offspring){var i=t.x+t.width/2,n=t.y+t.height+e.LevelSeparation/2;o+="M "+i+" "+(t.y+t.height)+"L "+i+" "+n;var r=this.toNextLevelLeftMost(t),l=this.toNextLevelRightMost(t),f=r.x+r.width/2,h=r.y-e.LevelSeparation/2,p=l.x+l.width/2,a=l.y-e.LevelSeparation/2;o+="M "+f+" "+h+"L "+p+" "+a,this.calculatePath(t.offspring)}}}},i.prototype.finishCal=function(t){this.calculate(t,0),this.calculatePath(t)},i.prototype.preOrder=function(){},i.prototype.paint=function(t){this.postOrder(t),this.finishCal(t);for(var e=0;e<r.length;e++)for(var i=0;i<r[e].length;i++)this.context.strokeRect(r[e][i].x,r[e][i].y,r[e][i].width,r[e][i].height),this.context.fillText(r[e][i].key,r[e][i].x,r[e][i].y);var n=new Path2D(o);this.context.stroke(n)},i.prototype.repaint=function(){for(var t=0;t<r.length;t++)for(var e=0;e<r[t].length;e++)this.context.strokeRect(r[t][e].x,r[t][e].y,r[t][e].width,r[t][e].height),this.context.fillText(r[t][e].key,r[t][e].x,r[t][e].y);var i=new Path2D(o);this.context.stroke(i)},i.prototype.setDraggable=function(t,e){e=void 0===e?function(){}:e;var i=0,n=0,r=this,o=function(t){if(t.clientX!=i&&t.clientY!=n){var o=t.clientX-i,l=t.clientY-n;r.viewport.x-=o,r.viewport.y-=l,r.context.translate(o,l),r.context.clearRect(r.viewport.x,r.viewport.y,r.dom.width,r.dom.height),r.repaint(),e(),i=t.clientX,n=t.clientY}};t?(this.dom.addEventListener("mousedown",function(t){i=t.clientX,n=t.clientY,r.dom.addEventListener("mousemove",o)}),this.dom.addEventListener("mouseup",function(t){r.dom.removeEventListener("mousemove",o)})):this.dom.removeEventListener("drag",e)},i});